80 INPUT N:DIM S(N,N)
90 FOR I=1 TO N:FOR J=1 TO N
100 B=J-I+(N-1)\2:C=2*J-I
110 IF B>=N THEN B=B-N ELSE IF B<0 THEN B=B+N
120 IF C>N THEN C=C-N ELSE IF C<=0 THEN C=C+N
130 S(I,J)=B*N+C:NEXT J,I
140 FOR I=1 TO N:FOR J=1 TO N
150 PRINTUSING"####";S(I,J);:NEXTJ:PRINT:NEXTI
